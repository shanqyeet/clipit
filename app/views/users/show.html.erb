<h1>This is User Dashboard</h1>
<% if current_user %>
	<div>
		<%= link_to "change password", new_user_password_path %>
		<%= link_to "create brand", new_user_brand_path(current_user) %>
		<%= link_to "Archived", user_archived_list_path(current_user) %>
	</div>
<% end %>

<!-- Listing of all the brands owned by this user  -->
<div>
	<% if !@brand_list.nil? %>
		<% @brand_list.each do |brand| %>
			<% if brand.logo.file.nil? %>
			<%= image_tag("clipit-logo.png", width:"50px", height:"50px") %>
			<% else %>
			<%= image_tag("#{brand.logo.thumb}") %> 
			<% end %>
			<%= brand.name %> 
			<%= link_to "edit brand", edit_user_brand_path(brand.user_id, brand.id) %>
		<% end %>
	<% end %>
</div>


<div>
	<%= link_to "create CTA", new_user_call_to_action_path(current_user) %>
</div>


<!-- Listing of all call to actions created -->
<div>
	<h1>List of Call To Actions</h1>
	<% @cta_list.each do |x| %> 
		<div>
			<%= x.brand.name %> 
			<%= x.description %> 
			<%= x.count %>
			<%= link_to "Archive!", archive_cta_path(user_id: current_user.id, id:x.id), method: :post, data:{confirm:"Are you sure? This is archive all corresponding Clips"} %>
		</div>
	<% end %>
</div>

<div>
	<%= form_with url:user_clips_path(current_user) do |form| %>
	  <% if @clip.errors.any? %>
	    <div id="error_explanation">
	      <h2><%= pluralize(clip.errors.count, "error") %> prohibited this clip from being saved:</h2>

	      <ul>
	      <% @clip.errors.full_messages.each do |message| %>
	        <li><%= message %></li>
	      <% end %>
	      </ul>
	    </div>
	  <% end %>
		
	<%= form.hidden_field :user_id, value: current_user.id %>
    
    <%= form.label :select_cta %>
    <%= form.select :call_to_action_id, @cta_list.collect {|cta| [cta.description, cta.id] }%> 
	
	<%= form.label :page_link %> 
    <%= form.url_field :page_link, class:"form-control" %>

	<div class="actions">
		<%= form.submit %>
	</div>
	<% end %>
</div>


<!-- List of Clips  -->
<h1>List of Active Clips</h1>
<% if @clip_list.present? %>
	<% @clip_list.each do |x| %>
		<div>
			<%= x.call_to_action.description %>
			<%= x.page_link %> 
			
			<textarea id="link-source">
				<%= "http://localhost:3000/" + x.short_link %>
			</textarea> 
			<%= x.count %>
			<%= x.call_to_action.count %>
				<% if x.call_to_action != 0 && x.count != 0%>
					<%= ((x.call_to_action.count.to_f.round(4) / x.count.to_f.round(4))*100).to_s + "%" %>
				<% else %>
				<%= "not available" %>
				<% end %> 
			<button id="copy-to-clip" onclick="copyLink()">Copy</button>
			<%= link_to "View Page",user_clip_path(user_id: current_user.id, id: x.id),target:"_blank" %>
			<%= link_to "Archive!", archive_clip_path(user_id: current_user.id, id: x.id), method: :post %>
		</div>
	<% end %> 
<% end %> 